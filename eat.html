<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<!-- Global Site Tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-61548012-2"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());
		gtag('config', 'UA-61548012-2');
	</script>

<script>

var food_data = `
breakfast	4	$$$	Jake's at the Mill
breakfast	6	$$	Lone Wolf
breakfast	7	$	Brueggers
breakfast	9	$	Cushman
lunch	9	$	Crazy Noodles
lunch	10	$	Antonio's
lunch	8	$	Bueno E Sano
lunch	5	$$	The Works
lunch	5	$	Subway
lunch	7	$$	<i>Go somewhere new</i>
dinner	9	$	Bueno E Sano
dinner	4	$$$	Kaiju
dinner	10	$	Antonio's
dinner	9	$	AHOP
dinner	6	$	Mac n cheese
dinner	7	$	Frozen pizza
dinner	7	$$	<i>Go somewhere new</i>
`;

var places = food_data.split("\n");
places.shift(); // remove empty first item
places.pop(); // remove empty last item
for(var i = 0; i < places.length; i++) {
    places[i] = places[i].split("\t");
}


function updateaPlaces() {

    var breakfast = document.getElementById("breakfast").checked;
    var lunch = document.getElementById("lunch").checked;
    var dinner = document.getElementById("dinner").checked;
    var money1 = document.getElementById("$").checked;
    var money2 = document.getElementById("$$").checked;
    var money3 = document.getElementById("$$$").checked;

    var temp_places = [];

    document.getElementById("results").innerHTML = "";
    for(var i = 0; i < places.length; i++) {
        var is_meal = (
        (places[i][0] == "breakfast" && breakfast) ||
        (places[i][0] == "lunch" && lunch) ||
        (places[i][0] == "dinner" && dinner)
        );

        var is_money = (
        (places[i][2] == "$" && money1) ||
        (places[i][2] == "$$" && money2) ||
        (places[i][2] == "$$$" && money3)
        );

        if(is_meal && is_money) {

            // don't list "Antonio's" twice
            var already_added = false;
            for(var j = 0; j < temp_places.length; j++) {
                if (places[i][3] == places[j][3]) {
                    already_added = true;
                }
            }
            if(!already_added) {
                temp_places.push( places[i] );
            }
        }
    }

    // var random = Math.random();
    var shuffle_strength = 4;
    temp_places.sort((a, b) => b[1] - a[1] + Math.random()*shuffle_strength);

    for(var i = 0; i < temp_places.length; i++) {

        // document.getElementById("results").innerHTML += temp_places[i];
        document.getElementById("results").innerHTML += "<li>"+temp_places[i][3]+"</li>";
        // document.getElementById("results").innerHTML += "<br/>";
    }

}
window.onload = function() {
    updateaPlaces();
}


</script>

</head>
<body>

    <p><h1>Where should we eat?</h1></p>

    <p>
        <form id="myform">
            <label for="breakfast">Breakfast</label> <input type="checkbox" id="breakfast" value="breakfast" checked onchange="updateaPlaces()" />
            <label for="lunch">Lunch</label> <input type="checkbox" id="lunch" value="lunch" checked onchange="updateaPlaces()" />
            <label for="dinner">Dinner</label> <input type="checkbox" id="dinner" value="dinner" checked onchange="updateaPlaces()" />
            <br/>
            <label for="$">$</label> <input type="checkbox" id="$" value="$" checked onchange="updateaPlaces()" />
            <label for="$$">$$</label> <input type="checkbox" id="$$" value="$$" checked onchange="updateaPlaces()" />
            <label for="$$$">$$$</label> <input type="checkbox" id="$$$" value="$$$" checked onchange="updateaPlaces()" />
        </form>
    </p>

    <ol id="results"></ol>

</body>
</html>
